import{g as E,r as c,k as R,i as g,o as l,c as a,b as t,q as m,v as y,F as k,x as q,m as i,P,t as h,z as $,a as U}from"./DOh1AU71.js";import{u as D}from"./DuyO21MA.js";const F={class:"create-pr-form"},M={class:"form-group"},N=["disabled"],z=["value"],G={key:0,class:"helper-text"},I={class:"form-group"},L=["disabled"],j=["value"],A={key:0,class:"helper-text"},H={class:"form-group"},J=["placeholder","disabled"],K={key:0,class:"validation-error"},O={class:"form-group"},Q=["disabled"],W={key:0,class:"validation-summary"},X={key:0},Y={key:1},Z={key:2},ee={key:3},te={class:"form-actions"},se=["disabled"],le=["disabled"],ae=E({__name:"CreatePullRequest",props:{branches:{},currentBranch:{}},emits:["created","cancel"],setup(w,{emit:x}){const p=w,{createNewPullRequest:C,user:B}=D(),{showToast:_}=$(),S=x,u=c(!1),o=c("main"),r=c(""),d=c(""),v=c(""),f=c(!1);R(()=>{r.value=p.currentBranch});const T=g(()=>{var n;return r.value&&o.value?`${((n=B.value)==null?void 0:n.login)||"user"} wants to merge from ${r.value} into ${o.value}`:"Enter PR title"}),b=g(()=>o.value&&r.value&&d.value.trim()&&o.value!==r.value),V=async()=>{if(f.value=!0,!(!b.value||u.value)){u.value=!0;try{await C(o.value,r.value,d.value,v.value)&&(_({title:"Success",message:"Pull request created successfully",type:"success"}),d.value="",v.value="",o.value="",r.value="",S("created"))}catch(n){console.error("Error creating pull request:",n),_({title:"Error",message:n instanceof Error?n.message:"Failed to create pull request",type:"error"})}finally{u.value=!1}}};return(n,e)=>(l(),a("div",F,[e[12]||(e[12]=t("h3",{class:"form-title"},"Create Pull Request",-1)),t("div",M,[e[6]||(e[6]=t("label",{for:"base"},"Target Branch (merge into)",-1)),m(t("select",{id:"base","onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),class:"form-select",disabled:u.value},[e[5]||(e[5]=t("option",{value:""},"Select target branch",-1)),(l(!0),a(k,null,q(p.branches,s=>(l(),a("option",{key:s,value:s},h(s),9,z))),128))],8,N),[[y,o.value]]),o.value?i("",!0):(l(),a("span",G,"This is the branch where changes will be merged into"))]),t("div",I,[e[8]||(e[8]=t("label",{for:"head"},"Source Branch (merge from)",-1)),m(t("select",{id:"head","onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),class:"form-select",disabled:u.value},[e[7]||(e[7]=t("option",{value:""},"Select source branch",-1)),(l(!0),a(k,null,q(p.branches,s=>(l(),a("option",{key:s,value:s},h(s),9,j))),128))],8,L),[[y,r.value]]),r.value?i("",!0):(l(),a("span",A,"This is the branch containing your changes"))]),t("div",H,[e[9]||(e[9]=t("label",{for:"title"},"Title",-1)),m(t("input",{id:"title","onUpdate:modelValue":e[2]||(e[2]=s=>d.value=s),type:"text",class:"form-input",placeholder:T.value,disabled:u.value},null,8,J),[[P,d.value]]),f.value&&!d.value.trim()?(l(),a("span",K," Title is required ")):i("",!0)]),t("div",O,[e[10]||(e[10]=t("label",{for:"description"},"Description",-1)),m(t("textarea",{id:"description","onUpdate:modelValue":e[3]||(e[3]=s=>v.value=s),class:"form-textarea",placeholder:"Enter PR description",rows:"4",disabled:u.value},null,8,Q),[[P,v.value]])]),f.value&&!b.value?(l(),a("div",W,[e[11]||(e[11]=t("p",null,"Please fix the following issues:",-1)),t("ul",null,[o.value?i("",!0):(l(),a("li",X,"Select a target branch")),r.value?i("",!0):(l(),a("li",Y,"Select a source branch")),o.value===r.value&&o.value?(l(),a("li",Z," Target and source branches must be different ")):i("",!0),d.value.trim()?i("",!0):(l(),a("li",ee,"Enter a title for the pull request"))])])):i("",!0),t("div",te,[t("button",{class:"cancel-button",onClick:e[4]||(e[4]=s=>n.$emit("cancel")),disabled:u.value}," Cancel ",8,se),t("button",{class:"submit-button",onClick:V,disabled:!b.value||u.value},h(u.value?"Creating...":"Create Pull Request"),9,le)])]))}}),ue=U(ae,[["__scopeId","data-v-a85e91b6"]]);export{ue as default};
